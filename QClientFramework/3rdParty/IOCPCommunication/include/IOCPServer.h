#pragma once
/*************************************************************************
* function：iocp通讯定义文件
* author :	明巧文
* datetime：2017-12-14
* company: 
*************************************************************************/

#include "IOCPBase.h"

class IOCPServer : public IOCPBase
{
public:
	IOCPServer(INetInterface *pNet = nullptr);
	virtual ~IOCPServer();

	bool StartServer(USHORT nPort, unsigned dwMaxConnection = 10, unsigned uThreadCount = 0);
	void StopServer();

	//心跳检测函数，由主线程定时调用。
	void StartHeartbeatCheck();

private:
	/*************************************************************************
	* function：  开启针对服务端的监听
	* param port: 本地监听的端口号
	* param iMaxServerCount:最大的连接个数
	* return:	  成功返回true,失败返回false.
	*************************************************************************/
	bool StartServerListen(u_short port, unsigned iMaxConnectCount);

private:
	bool						m_bStart;
	PER_SOCKET_CONTEXT			*m_pListenSocketContext;	//监听socket上下文
};
